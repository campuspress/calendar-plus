{"version":3,"file":"editor-shortcode.js","mappings":"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","sources":["webpack://calendar-plus/./_src/admin/editor-shortcode/editor-shortcode.js"],"sourcesContent":["(function ($) {\n\ttinymce.PluginManager.add('calendarp_shortcodes', function (editor) {\n\t\tlet ed = tinymce.activeEditor;\n\n\t\tlet buildTermCheckboxes = function (values, prefix) {\n\t\t\tlet checkboxes = [];\n\n\t\t\tfor (let i in values) {\n\t\t\t\tif (values.hasOwnProperty(i)) {\n\t\t\t\t\tcheckboxes.push({\n\t\t\t\t\t\ttype: 'checkbox',\n\t\t\t\t\t\tname: prefix + values[i].value,\n\t\t\t\t\t\ttext: values[i].text,\n\t\t\t\t\t\tvalue: values[i].value\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn checkboxes;\n\t\t};\n\n\t\tlet categoryValues = ed.getLang('calendarp_l10n.category_field_values');\n\t\tlet tagValues = ed.getLang('calendarp_l10n.tag_field_values');\n\n\t\tlet categoriesCheckboxes = buildTermCheckboxes(categoryValues, 'category_');\n\t\tlet tagsCheckboxes = buildTermCheckboxes(tagValues, 'tag_');\n\n\t\tlet categoriesValues = categoryValues;\n\n\t\tlet calendarp_menu = [\n\t\t\t{\n\t\t\t\ttext: ed.getLang('calendarp_l10n.calendar_title'),\n\t\t\t\tonclick: function () {\n\t\t\t\t\teditor.windowManager.open({\n\t\t\t\t\t\ttitle: ed.getLang('calendarp_l10n.calendar_title'),\n\t\t\t\t\t\tbody: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttype: 'infobox',\n\t\t\t\t\t\t\t\tclasses: 'categories-infobox',\n\t\t\t\t\t\t\t\tminHeight: 50,\n\t\t\t\t\t\t\t\tborder: 'none'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttype: 'container',\n\t\t\t\t\t\t\t\tname: 'categories_list_start',\n\t\t\t\t\t\t\t\tlabel: ed.getLang('calendarp_l10n.category_field_title'),\n\t\t\t\t\t\t\t\titems: categoriesCheckboxes,\n\t\t\t\t\t\t\t\thtml: '<div class=\"calp_mce_categories_list\">'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttype: 'container',\n\t\t\t\t\t\t\t\tname: 'categories_list_end',\n\t\t\t\t\t\t\t\tlabel: '',\n\t\t\t\t\t\t\t\thtml: '</div>'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttype: 'listbox',\n\t\t\t\t\t\t\t\tname: 'default_view_field',\n\t\t\t\t\t\t\t\tlabel: ed.getLang('calendarp_l10n.default_view_title'),\n\t\t\t\t\t\t\t\tvalues: ed.getLang('calendarp_l10n.default_view_values'),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttype: 'listbox',\n\t\t\t\t\t\t\t\tname: 'time_format',\n\t\t\t\t\t\t\t\tlabel: 'Time format',\n\t\t\t\t\t\t\t\tvalues: [\n\t\t\t\t\t\t\t\t\t{text: '11:00 pm', value: 'g:i a'},\n\t\t\t\t\t\t\t\t\t{text: '23:00', value: 'H:i'}\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttype: 'listbox',\n\t\t\t\t\t\t\t\tname: 'dow_format',\n\t\t\t\t\t\t\t\tlabel: 'Day of the week format',\n\t\t\t\t\t\t\t\tvalues: [\n\t\t\t\t\t\t\t\t\t{text: 'Sunday', value: 'l'},\n\t\t\t\t\t\t\t\t\t{text: 'Sun', value: 'D'}\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttype: 'listbox',\n\t\t\t\t\t\t\t\tname: 'month_name_format',\n\t\t\t\t\t\t\t\tlabel: 'Month name format',\n\t\t\t\t\t\t\t\tvalues: [\n\t\t\t\t\t\t\t\t\t{text: 'Jan', value: 'M'},\n\t\t\t\t\t\t\t\t\t{text: 'January', value: 'F'}\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttype: 'listbox',\n\t\t\t\t\t\t\t\tname: 'day_format',\n\t\t\t\t\t\t\t\tlabel: 'Day format',\n\t\t\t\t\t\t\t\tvalues: [\n\t\t\t\t\t\t\t\t\t{text: '09', value: 'd'},\n\t\t\t\t\t\t\t\t\t{text: '9', value: 'j'}\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttype: 'listbox',\n\t\t\t\t\t\t\t\tname: 'date_format',\n\t\t\t\t\t\t\t\tlabel: 'Date format',\n\t\t\t\t\t\t\t\tvalues: [\n\t\t\t\t\t\t\t\t\t{text: '15/09', value: 'd/m'},\n\t\t\t\t\t\t\t\t\t{text: '15/9', value: 'j/n'},\n\t\t\t\t\t\t\t\t\t{text: '09/15', value: 'm/d'},\n\t\t\t\t\t\t\t\t\t{text: '9/15', value: 'n/j'}\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttype: 'infobox',\n\t\t\t\t\t\t\t\tclasses: 'day-format-infobox',\n\t\t\t\t\t\t\t\tminHeight: 34,\n\t\t\t\t\t\t\t\tborder: 'none'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t],\n\t\t\t\t\t\tonopen: function (e) {\n\t\t\t\t\t\t\te.target.$el.find('.mce-day-format-infobox')\n\t\t\t\t\t\t\t\t.append('<a target=\"_blank\" href=\"https://codex.wordpress.org/Formatting_Date_and_Time\">Documentation on date and time formatting</a>')\n\t\t\t\t\t\t\t\t.css({\n\t\t\t\t\t\t\t\t\tcolor: '#0073aa',\n\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\te.target.$el.find('.mce-categories-infobox')\n\t\t\t\t\t\t\t\t.prepend('<p>' + ed.getLang('calendarp_l10n.category_field_info') + '</p>');\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonsubmit: function (e) {\n\t\t\t\t\t\t\tlet category_field,\n\t\t\t\t\t\t\t\tdefault_view_field,\n\t\t\t\t\t\t\t\tselectedCategories,\n\t\t\t\t\t\t\t\ttime_format,\n\t\t\t\t\t\t\t\tdow_format,\n\t\t\t\t\t\t\t\tmonth_name_format,\n\t\t\t\t\t\t\t\tday_format,\n\t\t\t\t\t\t\t\tdate_format;\n\n\t\t\t\t\t\t\tselectedCategories = [];\n\t\t\t\t\t\t\tfor (i in categoriesValues) {\n\t\t\t\t\t\t\t\tif (categoriesValues.hasOwnProperty(i)) {\n\t\t\t\t\t\t\t\t\tif (true === e.data['category_' + categoriesValues[i].value]) {\n\t\t\t\t\t\t\t\t\t\tselectedCategories.push(categoriesValues[i].value);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (0 !== selectedCategories.length) {\n\t\t\t\t\t\t\t\tcategory_field = ' category=\"' + selectedCategories.join(',') + '\"';\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tcategory_field = '';\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (e.data.default_view_field !== 'month') {\n\t\t\t\t\t\t\t\tdefault_view_field = ' view=\"' + e.data.default_view_field + '\"';\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tdefault_view_field = '';\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (e.data.time_format !== ed.getLang('calendarp_l10n.default_time_format')) {\n\t\t\t\t\t\t\t\ttime_format = ' time_format=\"' + e.data.time_format + '\"';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\ttime_format = '';\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (e.data.dow_format !== 'l') {\n\t\t\t\t\t\t\t\tdow_format = ' dow_format=\"' + e.data.dow_format + '\"';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tdow_format = '';\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (e.data.month_name_format !== 'M') {\n\t\t\t\t\t\t\t\tmonth_name_format = ' month_name_format=\"' + e.data.month_name_format + '\"';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tmonth_name_format = '';\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (e.data.day_format !== 'd') {\n\t\t\t\t\t\t\t\tday_format = ' day_format=\"' + e.data.day_format + '\"';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tday_format = '';\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (e.data.date_format !== 'd/m') {\n\t\t\t\t\t\t\t\tdate_format = ' date_format=\"' + e.data.date_format + '\"';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tdate_format = '';\n\t\t\t\t\t\t\t}\n\n\n\t\t\t\t\t\t\teditor.insertContent('[calendarp-calendar'\n\t\t\t\t\t\t\t\t+ category_field\n\t\t\t\t\t\t\t\t+ default_view_field\n\t\t\t\t\t\t\t\t+ time_format\n\t\t\t\t\t\t\t\t+ dow_format\n\t\t\t\t\t\t\t\t+ month_name_format\n\t\t\t\t\t\t\t\t+ date_format\n\t\t\t\t\t\t\t\t+ day_format\n\t\t\t\t\t\t\t\t+ ']');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\ttext: ed.getLang('calendarp_l10n.events_by_cat_title'),\n\t\t\t\tonclick: function () {\n\t\t\t\t\teditor.windowManager.open({\n\t\t\t\t\t\ttitle: ed.getLang('calendarp_l10n.events_by_cat_title'),\n\t\t\t\t\t\tbody: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttype: 'infobox',\n\t\t\t\t\t\t\t\tclasses: 'categories-infobox',\n\t\t\t\t\t\t\t\tminHeight: 50,\n\t\t\t\t\t\t\t\tborder: 'none'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttype: 'container',\n\t\t\t\t\t\t\t\tname: 'events_by_cat_categories_list_start',\n\t\t\t\t\t\t\t\tlabel: ed.getLang('calendarp_l10n.events_by_cat_category_field_title'),\n\t\t\t\t\t\t\t\titems: categoriesCheckboxes,\n\t\t\t\t\t\t\t\thtml: '<div class=\"calp_mce_categories_list\">'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttype: 'container',\n\t\t\t\t\t\t\t\tname: 'events_by_cat_categories_list_end',\n\t\t\t\t\t\t\t\tlabel: '',\n\t\t\t\t\t\t\t\thtml: '</div>'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttype: 'container',\n\t\t\t\t\t\t\t\tname: 'events_by_cat_tags_list_start',\n\t\t\t\t\t\t\t\tlabel: ed.getLang('calendarp_l10n.events_by_cat_tag_field_title'),\n\t\t\t\t\t\t\t\titems: tagsCheckboxes,\n\t\t\t\t\t\t\t\thtml: '<div class=\"calp_mce_tags_list\">'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttype: 'container',\n\t\t\t\t\t\t\t\tname: 'events_by_cat_tags_list_end',\n\t\t\t\t\t\t\t\tlabel: '',\n\t\t\t\t\t\t\t\thtml: '</div>'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttype: 'textbox',\n\t\t\t\t\t\t\t\tname: 'events_by_cat_events_count_field',\n\t\t\t\t\t\t\t\tlabel: ed.getLang('calendarp_l10n.events_by_cat_events_count_field_title'),\n\t\t\t\t\t\t\t\tvalue: '0',\n\t\t\t\t\t\t\t\tmaxLength: 3,\n\t\t\t\t\t\t\t\tsize: 3\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t],\n\t\t\t\t\t\tonopen: function (e) {\n\t\t\t\t\t\t\te.target.$el.find('.mce-categories-infobox')\n\t\t\t\t\t\t\t\t.prepend('<p>' + ed.getLang('calendarp_l10n.events_by_cat_info') + '</p>');\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonsubmit: function (e) {\n\n\t\t\t\t\t\t\tlet extractTerms = function (values, prefix) {\n\t\t\t\t\t\t\t\tlet selected = [];\n\n\t\t\t\t\t\t\t\tfor (let i in values) {\n\t\t\t\t\t\t\t\t\tif (values.hasOwnProperty(i)) {\n\t\t\t\t\t\t\t\t\t\tif (true === e.data[prefix + values[i].value]) {\n\t\t\t\t\t\t\t\t\t\t\tselected.push(values[i].value);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\treturn selected;\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\tlet selectedCategories = extractTerms(categoryValues, 'category_');\n\t\t\t\t\t\t\tlet selectedTags = extractTerms(tagValues, 'tag_');\n\n\t\t\t\t\t\t\tlet category_field = (0 === selectedCategories.length) ? '' :\n\t\t\t\t\t\t\t\t' category=\"' + selectedCategories.join(',') + '\"';\n\n\t\t\t\t\t\t\tlet tag_field = (0 === selectedTags.length) ? '' :\n\t\t\t\t\t\t\t\t' tag=\"' + selectedTags.join(',') + '\"';\n\n\t\t\t\t\t\t\tlet events_field = (e.data.events_by_cat_events_count_field !== '0') ?\n\t\t\t\t\t\t\t\t' events=\"' + e.data.events_by_cat_events_count_field + '\"' : '';\n\n\t\t\t\t\t\t\teditor.insertContent('[calendarp-events-list' + category_field + tag_field + events_field + ']');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\ttext: ed.getLang('calendarp_l10n.single_event_title'),\n\t\t\t\tonclick: function () {\n\t\t\t\t\teditor.windowManager.open({\n\t\t\t\t\t\ttitle: ed.getLang('calendarp_l10n.single_event_title'),\n\t\t\t\t\t\tbody: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttype: 'textbox',\n\t\t\t\t\t\t\t\tname: 'event_title',\n\t\t\t\t\t\t\t\tclasses: 'event-title-field',\n\t\t\t\t\t\t\t\tlabel: ed.getLang('calendarp_l10n.search_event'),\n\t\t\t\t\t\t\t\tvalue: '',\n\t\t\t\t\t\t\t\tsize: 25\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttype: 'textbox',\n\t\t\t\t\t\t\t\tname: 'event_id',\n\t\t\t\t\t\t\t\tclasses: 'event-id-field',\n\t\t\t\t\t\t\t\tvalue: '',\n\t\t\t\t\t\t\t\thidden: true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t],\n\t\t\t\t\t\tonopen: function (e) {\n\t\t\t\t\t\t\tlet $el = jQuery(e.target.$el.find('.mce-event-title-field'));\n\t\t\t\t\t\t\t// Set a placeholder\n\t\t\t\t\t\t\t$el.attr('placeholder', ed.getLang('calendarp_l10n.search_event_by_title'));\n\t\t\t\t\t\t\tlet $idField = jQuery(e.target.$el.find('.mce-event-id-field'));\n\t\t\t\t\t\t\t$el.autocomplete({\n\t\t\t\t\t\t\t\tsource: function (request, response) {\n\t\t\t\t\t\t\t\t\tlet eventApi = new wp.api.collections.Calendar_event();\n\t\t\t\t\t\t\t\t\teventApi\n\t\t\t\t\t\t\t\t\t\t.fetch({data: {search: request.term}})\n\t\t\t\t\t\t\t\t\t\t.done(function (data) {\n\t\t\t\t\t\t\t\t\t\t\tlet dataLength = data.length,\n\t\t\t\t\t\t\t\t\t\t\t\tparsedData = [],\n\t\t\t\t\t\t\t\t\t\t\t\ti;\n\n\t\t\t\t\t\t\t\t\t\t\tfor (i = 0; i < dataLength; i++) {\n\t\t\t\t\t\t\t\t\t\t\t\tparsedData.push({\n\t\t\t\t\t\t\t\t\t\t\t\t\tid: data[i].id,\n\t\t\t\t\t\t\t\t\t\t\t\t\t// HTML is expected in title, just get the text\n\t\t\t\t\t\t\t\t\t\t\t\t\tlabel: jQuery('<span />').html(data[i].title.rendered).text()\n\t\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t// Return the data to autocomplete\n\t\t\t\t\t\t\t\t\t\t\tresponse(parsedData);\n\t\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tappendTo: $el.parent(),\n\t\t\t\t\t\t\t\tsearch: function () {\n\t\t\t\t\t\t\t\t\t$idField.val('');\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tselect: function (event, ui) {\n\t\t\t\t\t\t\t\t\t$idField.val(ui.item.id);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonsubmit: function (e) {\n\t\t\t\t\t\t\tlet event_id_field;\n\t\t\t\t\t\t\tif (e.data.event_id != 'all')\n\t\t\t\t\t\t\t\tevent_id_field = ' event_id=\"' + e.data.event_id + '\"';\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\tevent_id_field = '';\n\n\t\t\t\t\t\t\teditor.insertContent('[calendarp-event' + event_id_field + ']');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\n\t\teditor.addButton('calendarp_shortcodes', {\n\t\t\ticon: 'mce-i-calendarp',\n\t\t\tmenu: calendarp_menu,\n\t\t\ttype: 'menubutton'\n\t\t});\n\t});\n\n\n})(jQuery);\n"],"names":["jQuery","tinymce","PluginManager","add","editor","ed","activeEditor","buildTermCheckboxes","values","prefix","checkboxes","i","hasOwnProperty","push","type","name","value","text","categoryValues","getLang","tagValues","categoriesCheckboxes","tagsCheckboxes","categoriesValues","calendarp_menu","onclick","windowManager","open","title","body","classes","minHeight","border","label","items","html","onopen","e","target","$el","find","append","css","color","prepend","onsubmit","category_field","default_view_field","selectedCategories","time_format","dow_format","month_name_format","day_format","date_format","data","length","join","insertContent","maxLength","size","extractTerms","selected","selectedTags","tag_field","events_field","events_by_cat_events_count_field","hidden","attr","$idField","autocomplete","source","request","response","wp","api","collections","Calendar_event","fetch","search","term","done","dataLength","parsedData","id","rendered","appendTo","parent","val","select","event","ui","item","event_id_field","event_id","addButton","icon","menu"],"sourceRoot":""}